# Xmr-Stak Tweaking

Xmr-Stak is different than most miners in that most of the parameters are set via config files, as opposed to through command line options. This mean NHML will generate config files with the correct options for mining with selected devices.

Because of this, custom tweaking is done mainly through editing config files, and not the extra launch parameters section. All config files are found in the `bin\xmr-stak\` folder. For each type of config, there will be one generated on first launch of Xmr-Stak that you can edit, and one that NHML generates from these base files. The files generated from the base ones should *not* be edited directly as they are overwritten on every miner launch.

Following are details for each config file, and which parameters are overridden in NHML (i.e. edits will be ignored).

## Tweaking general config

The general config file is generated automatically by NHML the first time Xmr-Stak is run, and is named `config.txt`. 

Whenever NHML runs Xmr-Stak, it reads the `config.txt` file and generates a new `config_nh.txt` file. 

Values overridden by NHML when making `config_nh.txt`:

* `pool_list`
* `currency`
* `httpd_port`

In addition the following are overridden during benchmark only:

* `verbose_level`
* `h_print_time`
* `daemon_mode`
* `flush_stdout`
* `output_file`

## Tweaking device configs

All device config files are automatically generated by Xmr-Stak if they are not present. NHML will read these and use them to make the custom files when launching the miner. Mainly the only thing that is overridden is the selected indices for GPUs. 

When you first use Xmr-Stak, NHML will request that the miner generate these files since it selects optimal values for your system. Once the base configs are present, NHML will not request that Xmr-Stak regenerate them unless they are deleted/corrupted. If you have a device change it is recommended you delete the files so they can regenerate.

### Tweaking CPU config

The CPU config generated by Xmr-Stak is `cpu.txt` and is considered to have optimal values for your specific CPU. There is only one setting here, `cpu_threads_config`, which is described in the file. NHML copies this value over verbatim (provided it is entered correctly), so edits made here are honoured when launching the miner. The copied over file will generally be named `CPU-0.txt`. 

### Tweaking GPU config

The optimal GPU configs are generated by Xmr-Stak, `amd.txt` and `nvidia.txt`. Each file will have `gpu_threads_conf`, which contains entries describing values for each GPU in your system. You can see descriptions of the values in the file. In general, these values can be edited and will be copied over to the NHML generated configs, which are named based on selected GPUs e.g. `AMD_0,2.txt`. It is not recommended to change the `index` value as this is what identifies each GPU entry.

You can add duplicate entries to `gpu_threads_conf` for a single GPU index, NHML will take all entries it finds that match the indices used for the mining session. This can be useful for tweaking.

Values overridden by NHML:

* `gpu_threads_conf` entries will be excluded if they are not used in that miner session. E.g. if you have 2 AMD cards and you mine on only one, NHML will generate a file e.g. `AMD_0.txt` that only includes the details for the first GPU. This is how NHML tells Xmr-Stak which GPUs to mine on.

In addition for NVIDIA:

* `bfactor` and `bsleep` of the `gpu_threads_conf` entries are overridden since higher values are more conducive to GUI systems. This functionality can be disabled by adding `--keep-b` to the extra launch parameters.

## Using non-NH Xmr-Stak distributions

The Xmr-Stak version included with NHML is slightly customized to work better with the environment. If you use another download, not all functionality will be present. Namely, auto-generating of the base config files for devices may not work correctly. It's suggested that you manually run xmr-stak.exe in this case up to the point where it generates these files for you (you can quickly do this by entering dummy values like "a" for pool address etc, it does not need to connect to generate). Once they are generated once this does not need to be done again.

Also, most versions of Xmr-Stak require administrator rights to open, the NHML version does not. If you use one that does you will have to also run NHML as an admin so it can launch it.